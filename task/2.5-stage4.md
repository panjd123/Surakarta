# 阶段4：完善AI，完成可能的附加任务

> DDL：2024-05-27

## 任务

恭喜你来到了最后一个阶段，事实上这个阶段的所有任务，包括 AI 的进一步完善都是附加任务，你已经可以提前开香槟了，当然，如果你想在大作业部分获得等价 4.0 的分数，你必须再努力一下。

### 完善 AI

实现本地和联机时 AI 托管（如果在本地双方都开就是EVE，电脑对电脑，注意这里托管的意思是可以随时开关）。

另外，你还可以在这个阶段考虑提升 AI 的性能。

> 本来是必做任务，现在你可以视为附加任务之一，我们的最低要求是上阶段联机时的仅 AI 托管

### 附加任务

根据自己的兴趣和能力选择0-4个完成即可，本任务边际收益递减效应会非常强，请仔细考虑。不同任务的分数会因难度不一而略有不同。

1. 实现移动棋子时的动画（尽量包括绕外棋线）
2. 在重现对局中实现 `播放`,`暂停`,`上一步`,`下一步`,`到第_步` 等功能。
3. 重播对局时可以随时介入进行不一样的尝试，尝试后也可以还原并继续播放。
4. 完善网络部分1：实现结束后客户端发送 `READY_OP` 表示准备再来一局。
5. 完善网络部分2：实现多房间服务端，客户端发送`READY_OP`时指定房间号与执棋颜色，表示准备就绪，服务端在判断某房间两个客户端就绪后，向客户端发送`READY_OP`表示开始。
6. 完善网络部分3：实现服务端棋盘`GUI`界面，并可以随时选择显示或不显示棋盘。
7. AI 线程和图形界面线程独立，AI 托管可以随时关闭：如果不独立的话，当 AI 计算时间很长时，图形界面会呈现卡死的样子，但其实是因为他在运行AI，没法响应你的点击操作，所以要停止托管不能只靠简单地点击按钮。要解决这个问题，你需要给 AI 单独开一个线程，Qt 中有相关的库。
8. AI 进度条：在游戏界面显示正在计算的AI进度条。这是附加任务5的一个延伸，多线程是这个任务的前提，你需要尽量保证这个进度条是线性增长的，比如你不能简单地用搜索到第几层来当进度条，这是非线性的。
9. 进一步优化濒死提示：即进一步利用搜索或其他算法，连续预测后几步，然后同样要求禁止玩家或提示玩家必输的步。值得注意的是，这个提示不能影响游戏的正常进行，也就是说，如果你要沿用已有的AI算法，那么你要么保证这个AI的运算速度很快，不会让用户察觉到线程阻塞，要么就是多线程。如果玩家操作先于计算结果产生，那么忽略濒死提示即可。
10. 热情地帮助其他同学解决大作业中遇到的问题。

> 完成至少 2 个附加任务是本大作业获得 90 分的必要条件。
> 
> 原则上，你也可以自己设计其他的功能，但请不要应付，也不需要提前咨询助教，助教最后会根据你们的报告评判。

### 特别提示

请注重代码的结构和质量，而不是单纯的功能实现。

## 提交

无论你是否在截止时间前完成这一阶段的全部开发任务，请在 `submission/` 下你的小组文件夹中上传你第三阶段的阶段性报告，在报告中请简要描述你的小组分工、代码框架设计、遇到的问题及解决方法和其他你认为有必要的内容。

如果不参加小组展示，又完成了附加任务的，你需要在报告附[GIF图](https://www.screentogif.com/)，或者在某个空闲的上机课上找助教单独检查。

**重要提醒：请在上机课上找其他小组的同学进行联机的充分测试，以免影响最后的比赛。**
